# Installation for postgresql 

Шаг 1: Обновление системы

Bash

sudo dnf update -y
▌ Шаг 2: Установка репозитория PostgreSQL

Bash

sudo dnf install https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm -y
▌ Шаг 3: Установка сервера PostgreSQL

Выберите версию PostgreSQL, которую хотите установить. Например, для версии 14:

Bash

sudo dnf install postgresql14-server -y
▌ Шаг 4: Инициализация базы данных

Bash

sudo /usr/pgsql-14/bin/postgresql-14-setup initdb
▌ Шаг 5: Запуск службы PostgreSQL

Bash

sudo systemctl start postgresql-14
sudo systemctl enable postgresql-14
▌ Шаг 6: Проверка статуса службы

Bash

sudo systemctl status postgresql-14
▌ Шаг 7: Вход в консоль PostgreSQL

Используйте учетную запись postgres для входа в консоль:

Bash

sudo su - postgres
psql


# IP адрес, который прослушивает PostgreSQL (можно оставить *, чтобы слушал все интерфейсы)
listen_addresses = '*'

# Порт, на котором работает PostgreSQL (обычно 5432)
port = 5432

# Максимальное количество одновременных соединений
max_connections = 100

# Типичные директории журналов и временных файлов
log_directory = 'pg_log'          # Лог-файлы будут храниться в каталоге pg_log внутри каталога data
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'   # Формат имени журнала

# Настройки производительности
shared_buffers = 1GB              # Размер буферов памяти для обработки запросов
effective_cache_size = 4GB        # Предполагаемый объем доступной кэш-памяти ОС
work_mem = 64MB                   # Память для сортировок и хешей
maintenance_work_mem = 512MB      # Объем оперативной памяти для операций обслуживания (VACUUM, CREATE INDEX)
wal_level = replica               # Уровень записи WAL (для восстановления и репликаций)
checkpoint_timeout = 1h           # Интервал между контрольными точками
autovacuum = on                   # Автоматическая очистка таблиц включена


# Allow external connections 
# file vim /var/lib/pgsql/14/data/pg_hba.conf
host    all     all     0.0.0.0/0     md5 ### or change it to 192.168.0.0/24

# Create database
-- Подключаемся к консоли psql
$ sudo su - postgres
$ psql

-- Создаем нового пользователя с заданным именем и паролем
CREATE USER myapp_user WITH PASSWORD 'mysecretpassword';

-- Создаем новую базу данных и назначаем владельцем её новый пользователь
CREATE DATABASE myapp_db OWNER myapp_user;

-- Предоставляем права на подключение к новой БД новому пользователю
GRANT ALL PRIVILEGES ON DATABASE myapp_db TO myapp_user;

-- Выход из консоли psql
\\q

